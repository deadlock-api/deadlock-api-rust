DROP TABLE IF EXISTS mmr_history;

CREATE TABLE IF NOT EXISTS mmr_history
(
    account_id    UInt32,
    match_id      UInt64,
    start_time    DATETIME,
    player_score  Float64,
    rank          UInt32 ALIAS [
        0,
        11,
        12,
        13,
        14,
        15,
        16,
        21,
        22,
        23,
        24,
        25,
        26,
        31,
        32,
        33,
        34,
        35,
        36,
        41,
        42,
        43,
        44,
        45,
        46,
        51,
        52,
        53,
        54,
        55,
        56,
        61,
        62,
        63,
        64,
        65,
        66,
        71,
        72,
        73,
        74,
        75,
        76,
        81,
        82,
        83,
        84,
        85,
        86,
        91,
        92,
        93,
        94,
        95,
        96,
        101,
        102,
        103,
        104,
        105,
        106,
        111,
        112,
        113,
        114,
        115,
        116
        ][toUInt8(clamp(player_score, 0, 66) + 1)],
    division      UInt32 ALIAS rank / 10,
    division_tier UInt32 ALIAS rank % 10
) ENGINE = ReplacingMergeTree
      ORDER BY (account_id, match_id)
      SETTINGS allow_nullable_key = 1;

INSERT INTO default.mmr_history (account_id, match_id, player_score, start_time)
VALUES (57751689, 29769587, 32.84773432710465, '2024-12-04 05:35:46'),
       (176306552, 30631904, 28.721525466370828, '2024-12-18 16:15:45'),
       (202600673, 32021432, 21.961201611695287, '2025-01-19 19:02:59'),
       (55420255, 31097702, 58.64350162458405, '2024-12-28 14:29:17'),
       (54274727, 32033385, 46.55639563856756, '2025-01-19 23:28:49'),
       (1728894680, 33564612, 19.437447051280344, '2025-03-04 09:42:24'),
       (1131724979, 30706107, 24.09348439226693, '2024-12-20 02:00:00'),
       (920071630, 37106217, 10.514945910146611, '2025-06-18 16:39:15'),
       (182176252, 32849806, 14.708011745197156, '2025-02-12 02:47:36'),
       (32180137, 32662233, 29.66670935702431, '2025-02-06 17:07:58'),
       (1861605062, 34902668, 8.861508140669386, '2025-04-16 01:32:53'),
       (67076179, 36833185, 24.877950624494282, '2025-06-10 11:05:17'),
       (165801053, 30795108, 20.436525586429028, '2024-12-21 19:54:14'),
       (1607837277, 32726975, 37.18736499764596, '2025-02-08 16:43:04'),
       (904272620, 35834695, 10.5646514808568, '2025-05-15 11:04:18'),
       (839136219, 36643440, 31.497237385656298, '2025-06-05 00:47:33'),
       (159814087, 37908161, 37.252041578193015, '2025-07-15 12:24:17'),
       (65097639, 37927993, 25.449432739202607, '2025-07-16 02:36:07'),
       (171158938, 37472633, 26.79552978623558, '2025-06-30 13:13:23'),
       (596673578, 30166235, 17.88751003351664, '2024-12-09 19:55:30'),
       (1124935737, 30511463, 29.660940607148742, '2024-12-16 02:19:08'),
       (1536153841, 30415297, 24.957043590774514, '2024-12-14 11:45:29'),
       (317034970, 28800275, 22.351395131538826, '2024-11-23 14:35:42'),
       (236336150, 38182362, 28.72374627241179, '2025-07-24 22:14:53'),
       (163215735, 28965429, 14.300045055852081, '2024-11-24 22:06:25'),
       (178330052, 31122938, 30.25822574673785, '2024-12-29 01:17:39'),
       (463638961, 29648820, 36.30395197467213, '2024-12-02 16:31:01'),
       (115371330, 36565723, 54.70878089734046, '2025-06-02 19:34:07'),
       (91029623, 32493303, 54.54790063860624, '2025-02-01 14:56:19'),
       (90065526, 32172919, 27.824490700727452, '2025-01-23 15:08:07'),
       (155894279, 29479518, 37.04545032680742, '2024-11-30 18:17:01'),
       (865629070, 32146586, 30.38601052005022, '2025-01-22 20:04:11'),
       (74038873, 29333579, 45.55249592838091, '2024-11-29 01:53:06'),
       (986484728, 32022512, 15.136186500984484, '2025-01-19 19:22:31'),
       (1212090760, 31958172, 26.194882183161358, '2025-01-18 15:39:27'),
       (1071131943, 31332292, 28.380393803119773, '2025-01-03 02:04:08'),
       (1559098946, 35939908, 20.95587771669512, '2025-05-17 22:07:15'),
       (74983081, 33999545, 25.924805642071462, '2025-03-17 05:44:27'),
       (202144839, 34634469, 28.693724580332105, '2025-04-06 14:58:57'),
       (62782350, 31936661, 20.713045993946434, '2025-01-18 05:03:41'),
       (84161646, 38216210, 8.062999593217038, '2025-07-26 02:14:37'),
       (166874394, 37958088, 23.379542462867313, '2025-07-17 04:29:18'),
       (1583790656, 32378176, 7.269717680600236, '2025-01-29 01:05:10'),
       (42480587, 31057957, 21.66135515698293, '2024-12-27 17:04:17'),
       (1211340519, 28677918, 59.27008370889656, '2024-11-22 14:12:19'),
       (927937339, 38059860, 12.383943147033957, '2025-07-20 17:30:38'),
       (383047510, 30626103, 54.40114043250624, '2024-12-18 13:55:25'),
       (878488169, 37725219, 28.328180486924545, '2025-07-09 02:01:02'),
       (1427156756, 35428937, 14.214539799329527, '2025-05-04 23:04:13'),
       (1415619207, 32205676, 27.591228787837082, '2025-01-24 12:57:03'),
       (1068702908, 28762871, 24.10819471051583, '2024-11-23 05:37:05'),
       (265733296, 34460160, 25.475891930183433, '2025-03-31 17:13:57'),
       (144891328, 36160965, 41.34102541595435, '2025-05-23 12:49:57'),
       (240808750, 33111928, 28.62696153029465, '2025-02-19 21:46:00'),
       (482646557, 31228754, 28.703970705541266, '2024-12-31 12:18:26'),
       (12561258, 34382774, 28.396670396880573, '2025-03-29 08:30:02'),
       (1551778030, 33672698, 10.112201577564885, '2025-03-07 16:33:45'),
       (1264636549, 38062947, 30.154325886752616, '2025-07-20 19:08:46'),
       (1886183304, 35195024, 47.19366770193048, '2025-04-26 17:27:26'),
       (75116891, 30498248, 38.257254821772406, '2024-12-15 20:33:35'),
       (440557549, 31490254, 32.99596914003492, '2025-01-06 18:07:21'),
       (1524130318, 38222936, 38.89794022560927, '2025-07-26 08:17:59'),
       (159325737, 34426643, 31.5657866771075, '2025-03-30 15:35:17'),
       (1088008298, 36854552, 34.45292886328608, '2025-06-11 00:36:31'),
       (47367495, 35913984, 28.539213975121807, '2025-05-17 09:25:29'),
       (83173887, 30819479, 28.967080808616963, '2024-12-22 07:14:09'),
       (859658373, 35932654, 42.761371333381994, '2025-05-17 19:15:39'),
       (142783640, 36408108, 24.65689157187365, '2025-05-29 17:17:24'),
       (153951697, 35475059, 28.96953904558828, '2025-05-06 19:07:35'),
       (218086755, 36005836, 38.41114893507561, '2025-05-19 11:47:56'),
       (8025140, 30852144, 41.03515835441795, '2024-12-22 20:57:49'),
       (247420632, 29334043, 37.11999306991048, '2024-11-29 02:03:07'),
       (1172329342, 33336431, 35.227624461752626, '2025-02-26 15:31:39'),
       (213652091, 33893206, 39.53890579617349, '2025-03-14 05:15:37'),
       (427524496, 35435718, 18.231639957551984, '2025-05-05 05:09:18'),
       (200314631, 31017858, 45.0625791240885, '2024-12-26 18:26:26'),
       (489817670, 29124071, 24.933810755192123, '2024-11-26 16:54:14'),
       (1227823105, 35112537, 31.75804670921554, '2025-04-23 16:01:01'),
       (113636423, 33054320, 14.908803785416527, '2025-02-18 00:54:32'),
       (431259868, 34609250, 21.24625866613991, '2025-04-05 19:32:43'),
       (143500521, 36574748, 10.27744530465123, '2025-06-03 00:39:41'),
       (897468523, 33684099, 34.704707554690515, '2025-03-07 22:19:29'),
       (93976618, 30827633, 39.95848843505174, '2024-12-22 11:57:22'),
       (116951013, 34677771, 36.93657729476549, '2025-04-07 23:49:36'),
       (113854943, 32826399, 15.77866412806592, '2025-02-11 11:56:38'),
       (1706410608, 30308493, 31.694700172426522, '2024-12-12 11:18:32'),
       (1109636057, 30751180, 18.70906288083712, '2024-12-20 23:16:02'),
       (82915716, 30317706, 15.32079806586405, '2024-12-12 15:34:14'),
       (913148397, 33670875, 44.64763297234446, '2025-03-07 15:26:53'),
       (368712534, 36430656, 37.73698051181283, '2025-05-30 06:42:34'),
       (1356884193, 30886707, 17.47386621996795, '2024-12-23 16:24:13'),
       (195531373, 35888377, 29.94235424132684, '2025-05-16 19:06:05'),
       (106837949, 29764960, 45.465772478269024, '2024-12-04 03:54:37'),
       (237666461, 35327912, 32.17165013559296, '2025-05-01 14:18:37'),
       (1197765563, 33285749, 14.477074863366035, '2025-02-25 10:32:52'),
       (1015635223, 29444100, 32.366452551095804, '2024-11-30 09:28:59'),
       (431234879, 36357399, 27.438594930532055, '2025-05-28 07:17:19'),
       (40223530, 31835564, 15.990967770217686, '2025-01-15 16:49:00'),
       (82798953, 36787174, 27.47453935193699, '2025-06-09 00:21:26'),
       (1030684292, 31305591, 28.820385163496677, '2025-01-02 13:26:30'),
       (154594596, 32789786, 42.21533145141684, '2025-02-10 08:01:47'),
       (159519140, 34382123, 19.700440612650826, '2025-03-29 07:45:41'),
       (1187054949, 38274316, 13.770733565487513, '2025-07-27 22:05:15'),
       (204712317, 38135939, 31.017724331147363, '2025-07-23 06:43:50'),
       (346637489, 32047635, 25.811854815811703, '2025-01-20 08:28:16'),
       (50752045, 29011603, 15.165451727698295, '2024-11-25 11:40:29'),
       (42186421, 38260951, 43.72893757346819, '2025-07-27 14:32:34'),
       (918421385, 29610892, 30.127582303818212, '2024-12-02 02:17:53'),
       (321263386, 34731285, 29.773744567140827, '2025-04-09 23:34:48'),
       (198650021, 29064473, 16.291468725138525, '2024-11-25 23:18:22'),
       (163582825, 34407081, 22.475045980376777, '2025-03-29 23:48:13'),
       (140251652, 36560915, 33.0867832503522, '2025-06-02 17:19:21'),
       (122572345, 32258495, 40.46038941417299, '2025-01-25 19:22:36'),
       (105124804, 35459237, 63.34056373368188, '2025-05-06 02:38:44'),
       (465769944, 29060930, 39.77376058278031, '2024-11-25 22:21:36'),
       (118710104, 28790268, 44.84097003601662, '2024-11-23 12:40:03'),
       (1836519310, 36369626, 25.502905553654266, '2025-05-28 16:51:51'),
       (81713866, 30533472, 18.555020311161915, '2024-12-16 15:53:39'),
       (1121967725, 30368659, 30.04228667077887, '2024-12-13 15:35:42'),
       (388063335, 37825662, 17.298260343117896, '2025-07-12 17:59:49'),
       (114674727, 29603590, 29.20594625647312, '2024-12-02 00:12:28'),
       (337560812, 32102630, 54.319649023936186, '2025-01-21 17:18:39'),
       (97652111, 37748160, 65.8913091428293, '2025-07-09 22:16:19'),
       (440777017, 30219469, 28.53669559914671, '2024-12-10 18:42:51'),
       (1068155688, 31559744, 30.516592761522247, '2025-01-08 12:35:48'),
       (183085287, 36119164, 18.6610485907749, '2025-05-22 08:51:29'),
       (146184501, 36386787, 28.17460432673344, '2025-05-29 01:45:27'),
       (211864471, 38250852, 41.60148388267508, '2025-07-27 05:07:02'),
       (1399236197, 34521607, 29.284348143528582, '2025-04-02 19:52:53'),
       (404699073, 35587556, 21.311814120383897, '2025-05-09 19:45:54'),
       (1050544730, 32491423, 19.972751734971776, '2025-02-01 13:47:57'),
       (158065638, 28724894, 18.252108558437413, '2024-11-22 21:45:19'),
       (862749354, 36615011, 25.998797472320387, '2025-06-04 04:35:48'),
       (1208725319, 29683478, 37.2949015787912, '2024-12-03 01:29:44'),
       (145384747, 30441007, 18.84650472507165, '2024-12-14 20:39:21'),
       (326894313, 29316749, 44.295498496453796, '2024-11-28 20:37:55'),
       (1257397477, 30651332, 25.26890001441406, '2024-12-18 23:10:51'),
       (313476273, 36787144, 11.668631146525454, '2025-06-09 00:20:29'),
       (208213895, 30433682, 21.01994983304303, '2024-12-14 18:28:47'),
       (1108419403, 37578856, 32.24096998339597, '2025-07-04 04:52:45'),
       (107507719, 38105100, 24.676528725508156, '2025-07-22 03:45:31'),
       (162350401, 30696215, 20.48224391776852, '2024-12-19 21:14:05'),
       (1056374521, 34731115, 51.787659196995456, '2025-04-09 23:26:18'),
       (229298471, 30779724, 20.30472740234166, '2024-12-21 14:28:44'),
       (5273510, 30691187, 39.48984170384803, '2024-12-19 19:30:20'),
       (332196954, 31320286, 48.70195711075001, '2025-01-02 20:15:14'),
       (253101336, 32114720, 22.778194689599356, '2025-01-21 22:44:10'),
       (1171437490, 36063210, 19.890715265212883, '2025-05-20 20:57:42'),
       (873737124, 30441957, 41.000365226564014, '2024-12-14 20:56:06'),
       (251094273, 35173639, 25.83946979389757, '2025-04-25 22:22:25'),
       (875973373, 30343208, 25.69737209943513, '2024-12-13 00:59:24'),
       (1688511582, 37261221, 31.9484049891593, '2025-06-23 10:52:19'),
       (24270498, 37766334, 15.841215306994092, '2025-07-10 16:07:29'),
       (137040911, 29615164, 14.304696482361992, '2024-12-02 03:32:38'),
       (416180910, 33168463, 44.655582640181166, '2025-02-21 19:35:12'),
       (912279419, 32486744, 17.305997467903783, '2025-02-01 10:22:43'),
       (906078921, 30769333, 20.959477231536116, '2024-12-21 09:15:51'),
       (887637515, 37544384, 1.0316838130400376, '2025-07-02 23:11:51'),
       (84111810, 29360906, 36.0619578815437, '2024-11-29 12:16:51'),
       (296738208, 33738379, 33.328375292159585, '2025-03-09 11:18:08'),
       (205717050, 31812286, 41.13696755285559, '2025-01-14 22:09:47'),
       (91495558, 29682116, 39.95726325449353, '2024-12-03 01:04:09'),
       (360155858, 34907085, 39.03331248815979, '2025-04-16 06:01:54'),
       (1029808347, 31370460, 31.46824611501833, '2025-01-03 23:23:27'),
       (312130376, 28731947, 33.13870392027082, '2024-11-22 23:04:18'),
       (126919190, 35071468, 23.858536352097325, '2025-04-21 23:17:22'),
       (893263048, 29084695, 28.04872960098594, '2024-11-26 04:33:41'),
       (130810321, 37759629, 14.700676914727334, '2025-07-10 09:07:20'),
       (132606788, 28756721, 49.41838146864542, '2024-11-23 04:18:34'),
       (1148280102, 38287669, 51.85465514048926, '2025-07-28 10:30:20'),
       (202706342, 33452870, 21.19992453680028, '2025-03-01 13:03:33'),
       (1206805282, 37716519, 25.72805196618578, '2025-07-08 19:52:53'),
       (382869437, 38289161, 42.944178508793165, '2025-07-28 12:13:06'),
       (1041277404, 29333566, 41.62406446847415, '2024-11-29 01:52:49'),
       (134387775, 31621208, 19.802945436309273, '2025-01-10 01:05:15'),
       (92369941, 30696273, 24.05282692039497, '2024-12-19 21:15:12'),
       (1591197043, 31172194, 48.816164299159304, '2024-12-30 02:39:48'),
       (1524205385, 29850075, 41.74959090741345, '2024-12-05 10:39:50'),
       (102107616, 38115328, 42.29272414879943, '2025-07-22 15:15:04'),
       (334568620, 32340607, 29.765950155392993, '2025-01-27 21:24:51'),
       (1223254533, 34552317, 29.968789846571564, '2025-04-03 21:51:41'),
       (1023619001, 35300594, 25.865646041383258, '2025-04-30 14:30:32'),
       (234071098, 35724736, 23.591573863370353, '2025-05-12 17:15:50'),
       (181436355, 34174181, 17.37294086808796, '2025-03-22 19:45:13'),
       (448241372, 37456081, 64.32878020950719, '2025-06-29 21:28:10'),
       (393803200, 32835187, 21.712178154424638, '2025-02-11 17:52:14'),
       (98587837, 38260111, 41.71426578991671, '2025-07-27 13:55:54'),
       (25958043, 33308277, 30.606015147922996, '2025-02-26 00:21:50'),
       (438025075, 29332264, 52.9737202697218, '2024-11-29 01:24:18'),
       (152829083, 34359691, 10.535509049293058, '2025-03-28 16:53:37'),
       (212797162, 32213914, 46.6183366957911, '2025-01-24 17:40:09'),
       (1743188925, 35023208, 19.14023019142627, '2025-04-20 08:29:12'),
       (294187187, 30263518, 11.123023831917148, '2024-12-11 15:09:58'),
       (281521966, 36003687, 32.4078202151386, '2025-05-19 09:45:41'),
       (888039193, 37472908, 53.64089388257101, '2025-06-30 13:27:25'),
       (223855201, 31510115, 47.581426895302826, '2025-01-07 03:58:11'),
       (62016331, 37327018, 4.858692580191816, '2025-06-25 16:25:11'),
       (1075151398, 30993172, 47.27444349664036, '2024-12-26 03:15:53'),
       (31495269, 32200056, 15.151156236809868, '2025-01-24 07:30:04'),
       (194327596, 32821486, 34.276739377564496, '2025-02-11 06:18:29');
