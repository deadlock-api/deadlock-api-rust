create table if not exists mmr_history
(
    account_id    UInt64,
    match_id      UInt64,
    player_score  Float32,
    rank          UInt32 alias [0, 11, 12, 13, 14, 15, 16, 21, 22, 23, 24, 25, 26, 31, 32, 33, 34, 35, 36, 41, 42, 43, 44, 45, 46, 51, 52, 53, 54, 55, 56, 61, 62, 63, 64, 65, 66, 71, 72, 73, 74, 75, 76, 81, 82, 83, 84, 85, 86, 91, 92, 93, 94, 95, 96, 101, 102, 103, 104, 105, 106, 111, 112, 113, 114, 115, 116][toUInt8(clamp(player_score, 0, 66) + 1)],
    division      UInt32 alias rank / 10,
    division_tier UInt32 alias rank % 10
)
    engine = ReplacingMergeTree
        ORDER BY (account_id, match_id)
        SETTINGS index_granularity = 8192;

INSERT INTO default.mmr_history (account_id, match_id, player_score)
VALUES (18373975, 28684967, 48.211376),
       (18373975, 28688991, 48.249775),
       (18373975, 28924306, 48.117184),
       (18373975, 28928103, 47.95047),
       (18373975, 29027469, 47.98852),
       (18373975, 29029367, 47.937233),
       (18373975, 29561860, 48.26034),
       (208770244, 29364523, 18.846474),
       (1575968547, 36295053, 20.413654),
       (1287184521, 30773842, 23.024076),
       (1089441137, 35071400, 31.733614),
       (147906248, 29093605, 21.912563),
       (117160872, 34387050, 10.008528),
       (1179025191, 36525268, 2.3589358),
       (173630582, 30135002, 12.846246),
       (276450782, 33309731, 26.294388),
       (916104491, 35650675, 21.004011),
       (88894095, 29345616, 39.05189),
       (378767780, 30953756, 22.607359),
       (37001837, 34699651, 32.660732),
       (84679871, 29055048, 28.338316),
       (986727714, 31745551, 19.88272),
       (44887113, 36531833, 21.954601),
       (1566814695, 31544149, 18.701714),
       (107591095, 30234100, 28.829947),
       (225136894, 31220499, 42.69959),
       (31034483, 32164394, 19.706413),
       (169155974, 28873428, 35.424774),
       (1187214802, 30604117, 31.393366),
       (155900946, 31725294, 31.424303),
       (85060014, 31374309, 46.65801),
       (1842017981, 31910465, 32.33957),
       (246854217, 35005672, 42.515614),
       (186516346, 30565312, 41.558544),
       (117365766, 35713506, 27.070919),
       (845618054, 28974158, 34.280064),
       (902846195, 34660740, 15.741349),
       (108540167, 34288287, 27.06812),
       (249792145, 32617919, 22.27639),
       (210300294, 36267423, 36.25844),
       (1169361030, 33606741, 48.98482),
       (167747435, 31818110, 38.983494),
       (1557956389, 30584692, 20.295683),
       (1840856502, 32373342, 34.710743),
       (118035472, 31042238, 22.563524),
       (173468414, 32323019, 12.891482),
       (73143430, 35381762, 47.619175),
       (215808279, 29474559, 34.44745),
       (395393734, 30855496, 57.77637),
       (1251772653, 31937822, 9.369094),
       (1383169738, 31048412, 29.770454),
       (39169298, 35264729, 6.936607),
       (36334719, 29798069, 14.8506365),
       (1182745535, 32440221, 27.52314),
       (1109371745, 31092606, 44.92776),
       (111600333, 35524648, 20.92901),
       (302161683, 34695930, 28.64238),
       (147795043, 33687117, 42.477524),
       (144902631, 36577489, 62.59575),
       (1122151804, 35889453, 46.251343),
       (1070234818, 36133515, 13.816221),
       (127697029, 31916495, 29.051977),
       (13026450, 35515398, 44.55883),
       (40141430, 32273760, 37.799362),
       (403598879, 29278177, 41.948116),
       (969594584, 33201793, 7.4777336),
       (161846752, 32467206, 24.922646),
       (999379894, 29501868, 24.68624),
       (108309884, 29445210, 28.58045),
       (2693986, 36538289, 23.725296),
       (139039294, 35292964, 24.19203),
       (1076832720, 33692523, 21.165174),
       (1007399472, 36002217, 37.189903),
       (1419249918, 34260976, 21.5127),
       (87561783, 31774091, 36.28051),
       (10869519, 36580623, 11.545055),
       (11072687, 33553432, 36.59578),
       (101809372, 30859642, 41.12356),
       (1105388399, 36189802, 17.655375),
       (172271682, 31440031, 36.210873),
       (1136715023, 35365625, 14.876974),
       (1268991247, 30302504, 21.308577),
       (194413375, 34680138, 34.24627),
       (1172895591, 30573682, 23.813162),
       (1263183002, 29432327, 30.597153),
       (353258258, 33858480, 39.701828),
       (221574879, 33191286, 58.152405),
       (95231377, 34407819, 22.496162),
       (352508996, 33179648, 49.439327),
       (94157613, 36616992, 29.20941),
       (115696028, 35977157, 35.86202),
       (448605604, 30780106, 32.60122),
       (44072373, 36168785, 27.46878),
       (1545244398, 35692903, 28.230211),
       (186673514, 36583732, 28.645187),
       (1048010877, 33600012, 15.539361),
       (1164255114, 32061773, 28.945368),
       (89127458, 36201990, 26.66014),
       (1511569704, 31209874, 29.42393),
       (1620151416, 33380419, 27.869967),
       (457766198, 29286787, 33.218857),
       (91120234, 36549081, 31.89254),
       (1168903422, 36014649, 20.843672),
       (179485894, 34526864, 27.755342),
       (75751156, 29363109, 36.627094),
       (114077507, 30076654, 35.898888),
       (293471412, 35499992, 40.267323),
       (103084627, 29569042, 10.44594),
       (1173234433, 35210673, 42.43866),
       (1097815904, 36385573, 27.510954),
       (39548793, 28967542, 31.895847),
       (206742929, 36226481, 28.367092),
       (204995824, 35531038, 4.9030614),
       (74049053, 30970588, 2.7466114),
       (84819538, 35631639, 38.844254),
       (98057590, 30497521, 33.723125),
       (1068574618, 30477717, 32.68525),
       (210819442, 36385012, 21.870937),
       (1279351742, 32434812, 39.657036),
       (1229294667, 28952559, 46.69627),
       (229107690, 29376249, 10.915371),
       (202944713, 36492245, 19.510485),
       (1105606677, 30668646, 54.613148),
       (404941811, 32967999, 25.399076),
       (124910900, 29295212, 9.7110405),
       (5477866, 31046624, 26.48265),
       (1009158234, 31276104, 21.683147),
       (46611170, 30597484, 43.180725),
       (1271984595, 35027572, 17.905308),
       (126859994, 32845624, 15.0071745),
       (1832033884, 36560525, 38.34453),
       (1349940248, 29364859, 43.89306),
       (1126532807, 30217856, 49.17689),
       (1524973833, 31740072, 32.27194),
       (1073191007, 32820156, 21.207726),
       (185787762, 33418605, 44.618946),
       (117743072, 29156354, 43.906166),
       (22205269, 30434306, 17.422176),
       (140391738, 33773262, 38.256073),
       (1238414570, 30077200, 30.262808),
       (1693200309, 34428188, 30.448061),
       (107843125, 34263345, 14.860391),
       (1187731173, 32665884, 21.057312),
       (1277304656, 29136400, 23.82892),
       (86937267, 29576801, 36.95815),
       (71729884, 30940823, 36.27671),
       (1774285487, 36544497, 42.38708),
       (314981321, 30771524, 32.584164),
       (366615208, 34216486, 23.794088),
       (1215139111, 36201083, 30.275642),
       (36096499, 32060865, 33.177967),
       (79192770, 29838527, 55.53815),
       (85322374, 28682122, 16.728739),
       (127017833, 29841085, 26.319927),
       (11823108, 30762460, 31.246355),
       (55552611, 33108313, 42.22959),
       (200580529, 36633047, 28.355255),
       (129384778, 32353966, 53.517025),
       (924438097, 33951786, 44.695297),
       (102547711, 35869167, 6.68465),
       (465234935, 30670371, 14.951568),
       (1252519561, 33188656, 18.055672),
       (117179923, 36043330, 25.368717),
       (254327204, 35042372, 51.21261),
       (219123897, 36581693, 28.445501),
       (1135148134, 29690268, 25.815937),
       (429777493, 30543975, 43.00604),
       (32684177, 31278892, 38.60389),
       (1012563734, 30803943, 33.016945),
       (1205455167, 33029960, 34.753754),
       (322793262, 33221480, 38.070873),
       (331202355, 32702366, 31.18183),
       (316718166, 32090187, 29.20991),
       (82919944, 35835251, 32.653145),
       (106760560, 35474943, 36.51939),
       (308054136, 34273809, 22.30351),
       (390951957, 33169755, 48.34942),
       (84411689, 32547428, 45.89705),
       (438265226, 32297408, 27.897438),
       (1841990944, 35417444, 14.234797),
       (1256496643, 32138363, 31.018652),
       (854920515, 32758091, 28.392866),
       (341391362, 36406005, 28.979187),
       (341391362, 34210431, 29.216564),
       (131629483, 28710646, 15.814997),
       (224860494, 31076594, 27.857853),
       (185123789, 32427657, 22.915869),
       (1516461597, 33367585, 20.051474),
       (69988097, 36418762, 49.469646),
       (114690636, 30838376, 31.543211),
       (901967527, 28915043, 17.506607),
       (399882685, 35709849, 41.428173),
       (1599304179, 36171112, 25.804842),
       (196326253, 36580626, 42.124004),
       (144276349, 30000219, 37.933464),
       (319209675, 35529800, 35.33525),
       (889108172, 30098087, 41.318184),
       (1901657135, 36610879, 51.60616),
       (902999562, 31537896, 44.851746),
       (1038022730, 36623439, 8.213637),
       (291317290, 36573220, 34.310795),
       (1506309669, 29878625, 1.1759665),
       (883696029, 33799285, 26.939297),
       (1397608026, 32650005, 21.815113),
       (951089316, 30500776, 9.436678),
       (1271960223, 36642397, 44.474483),
       (877249677, 36032494, 32.351444);
